import{o as e}from"./rolldown-runtime-BvjVq7TH.js";import{C as t,F as i,G as o,H as a,I as n,J as d,K as l,Ot as s,Tt as r,U as m,W as h,Y as u,a as c,bt as g,dt as p,ft as T,gt as v,ht as P,it as w,lt as b,o as E,ot as f,s as C,t as A,ut as D,w as S,wt as y,xt as k,y as _}from"./.pnpm-BUl7oEdQ.js";import{a as L,i as F,n as x,t as I}from"./index-YhVqJxEb.js";let V=function(e){return e.screenPosition="screenPosition",e.WGS84="WGS84",e.localPosition="localPosition",e}({});var G=class{constructor(e,t=V.WGS84){this.viewer=e,this.type=t}startLeftCilck(e){this.hander=new t(this.viewer.scene.canvas),this.hander.setInputAction(t=>{const i=this.viewer.scene.pickPosition(t.position);if(i){const t=h.fromCartesian(i),o=u.toDegrees(t.longitude),a=u.toDegrees(t.latitude),n=t.height;e({longitude:o,latitude:a,height:n})}else alert("未拾取到坐标")},S.LEFT_CLICK)}endDobuleLeftClick(){this.hander.setInputAction(()=>{this.destroyedClick()},S.LEFT_DOUBLE_CLICK)}destroyedClick(){this.hander&&(this.hander.removeInputAction(S.LEFT_CLICK),this.hander.removeInputAction(S.LEFT_DOUBLE_CLICK),this.positions=[],this.type=V.WGS84,this.hander=null)}getLocalPositionsFromType(e){switch(e){case V.screenPosition:return this.getScreenPositionFromCartesian2();case V.WGS84:return this.getCartographicFromCartesian3();case V.localPosition:return this.getLocalPositionFromCartesian3()}}getCartographicFromCartesian3(){if(0===this.positions.filter(e=>e.x&&e.y&&e.z).length)return[];const e=this.positions.map(e=>h.fromCartesian(e));return this.positions=[],e}getScreenPositionFromCartesian2(){return this.positions.map(e=>e)}getLocalPositionFromCartesian3(){if(this.type!==V.localPosition)return[]}getLocalPositionFromCartographic(){return this.positions.map(e=>e)}getLocalPositionFromCartesian2(){return this.positions.map(e=>e)}cartesianToWGS84(e){const t=h.fromCartesian(e);return{longitude:A(t.longitude),latitude:A(t.latitude),height:t.height}}getCartesian3FromCartesian2(e){return new d(e.x,e.y,0)}};const W=({position:e,Cartographic:t,uri:i="/models/CesiumMilkTruck.glb",id:o})=>{if(!e)throw new Error("position is required");const a=d.fromDegrees(e.longitude,e.latitude,e.height);return F.viewer.entities.add({id:o,position:a,model:new n({show:!0,uri:i,scale:3})})},z=({position:e,uri:t="/models/CesiumMilkTruck.glb",id:a})=>{if(!e.x||!e.y||!e.z)throw new Error("position is required");const l=e;return F.viewer.entities.add({id:a,position:l,model:new n({show:!0,uri:t,scale:3}),path:new i({show:!0,width:5,material:new o(1,0,0,1),leadTime:3}),viewFrom:new d(-5,-50,85)})},j=[{longitude:110.16748514148215,latitude:19.973827487478,height:27.960608727771973},{longitude:110.16662761623776,latitude:19.973688892032623,height:29.245206453240176},{longitude:110.16609681493883,latitude:19.973586924549508,height:30.030275456524052},{longitude:110.16497880694374,latitude:19.97342526624608,height:31.590392852644353},{longitude:110.16354899022103,latitude:19.973188078858282,height:33.60111077860449},{longitude:110.16271006842506,latitude:19.97310349095885,height:34.684955968455895},{longitude:110.16237364194511,latitude:19.973007990364305,height:35.09744217699289},{longitude:110.16238831537264,latitude:19.97286176599862,height:35.289536555348754},{longitude:110.16260225224441,latitude:19.972865751556782,height:34.99586509724263},{longitude:110.16383876747562,latitude:19.97304734724631,height:33.23181046176264},{longitude:110.16544332937218,latitude:19.973298567895693,height:30.981968581023118},{longitude:110.16645859786196,latitude:19.973485423798667,height:29.581416597760256},{longitude:110.16740325763367,latitude:19.973631477171285,height:28.19089984108092},{longitude:110.16764898311644,latitude:19.973721395336298,height:27.907266011347108}],K=[{longitude:107.2393666697779,latitude:24.155651832154636,height:246.7753646317451},{longitude:107.23943198880657,latitude:24.155467296834463,height:246.89342218759163},{longitude:107.23941503002676,latitude:24.15530924910863,height:246.9973747759727},{longitude:107.23919056789248,latitude:24.15526218400457,height:247.14909594638723},{longitude:107.23924906694458,latitude:24.155024199444448,height:247.13461898568616},{longitude:107.23933926359612,latitude:24.15462211947499,height:245.21934878502435},{longitude:107.2391680412638,latitude:24.154110718403338,height:243.51182261028913},{longitude:107.23909320835881,latitude:24.153823336031248,height:243.03499937085806},{longitude:107.23896723754262,latitude:24.153375655594452,height:242.70023842676397},{longitude:107.23885423203738,latitude:24.153245592999937,height:240.52755570894658},{longitude:107.23857169969617,latitude:24.153064515466692,height:238.603326662257},{longitude:107.2385148146397,latitude:24.153008794550743,height:238.36845569386543},{longitude:107.2385148146397,latitude:24.153008794550743,height:238.36845569386543},{longitude:107.23869916780596,latitude:24.152421384859228,height:238.01722371790208},{longitude:107.24018302804261,latitude:24.152527422019283,height:240.64268172524572},{longitude:107.24077602367211,latitude:24.153324799129702,height:252.18469433226565},{longitude:107.2408194257707,latitude:24.154584719544815,height:294.7093931932427},{longitude:107.23975020294432,latitude:24.155078276449906,height:270.54160937944},{longitude:107.2391630214458,latitude:24.15534946435742,height:247.12241164172656},{longitude:107.23858680536733,latitude:24.154775641009188,height:269.2830028371041},{longitude:107.2381376822359,latitude:24.154072954244864,height:244.5008755630832},{longitude:107.2381300696767,latitude:24.15318333215405,height:239.11125618818915},{longitude:107.2381300696767,latitude:24.15318333215405,height:239.11125618818915},{longitude:107.23840059889419,latitude:24.153587805001052,height:241.0480658597016},{longitude:107.2389142858752,latitude:24.153334725727664,height:241.82845155944506},{longitude:107.23896182748204,latitude:24.153338326929788,height:242.01882688476016},{longitude:107.23909584879938,latitude:24.153799547511742,height:242.92352472864343},{longitude:107.23921814083839,latitude:24.15419626171063,height:243.6664523532686},{longitude:107.23932464557184,latitude:24.15442892069666,height:244.1186671070634},{longitude:107.23933893562894,latitude:24.154629041159634,height:245.38027861038222},{longitude:107.23924532864834,latitude:24.155083294200047,height:247.3856995123078},{longitude:107.23916784465908,latitude:24.15535739374769,height:247.0503211806303},{longitude:107.2394257863195,latitude:24.155429250946757,height:246.97546541314208},{longitude:107.23940136311867,latitude:24.15561277953986,height:247.07623346279902}];var M=e=>({position:d.fromDegrees(e.longitude,e.latitude,e.height),hpr:new a(0,0,0)}),U=(e,{doc1:t,amb1:i,heli:o,amb2:a,doc2:n},{doc1EndTime:d,amb1EndTime:l,heliEndTime:s,amb2EndTime:r,doc2EndTime:h})=>m.lessThan(e,d)?t:m.lessThan(e,l)?i:m.lessThan(l,s)?o:m.lessThan(s,r)?a:m.lessThan(r,h)?n:void 0;const q=()=>{L.viewer.entities.removeAll();const{doc1Path:e,Am1Path:t,heliPath:i,Am2Path:o,doc2Path:a}=(K.length,{doc1Path:K.slice(0,3).map(e=>M(e)),Am1Path:K.slice(3,11).map(e=>M(e)),heliPath:K.slice(11,23).map((e,t)=>12===t||23===t?e:{...e,height:e.height+50}).map(e=>M(e)),Am2Path:K.slice(23,30).map(e=>M(e)),doc2Path:K.slice(30,33).map(e=>M(e))}),{doctor1StartPoint:n,Am1StartPoint:d,heliStartPoint:l,Am2StartPoint:s,doc2StartPoint:r}=(({doc1Path:e,Am1Path:t,heliPath:i,Am2Path:o,doc2Path:a})=>({doctor1StartPoint:e[0],Am1StartPoint:t[0],heliStartPoint:i[0],Am2StartPoint:o[0],doc2StartPoint:a[0]}))({doc1Path:e,Am1Path:t,heliPath:i,Am2Path:o,doc2Path:a}),{doc1:h,amb1:u,heli:c,amb2:g,doc2:p}=(({doctor1StartPoint:e,Am1StartPoint:t,heliStartPoint:i,Am2StartPoint:o,doc2StartPoint:a})=>(console.log(e.position,t.position,i.position,o.position,a.position,"ppppppppppp"),{doc1:z({position:e.position,uri:"/models/doctor.glb",id:"doc1"}),amb1:z({position:t.position,uri:"/models/CesiumMilkTruck.glb",id:"amb1"}),heli:z({position:i.position,uri:"/models/CH-47.glb",id:"heli"}),amb2:z({position:o.position,uri:"/models/CesiumMilkTruck.glb",id:"amb2"}),doc2:z({position:a.position,uri:"/models/doctor.glb",id:"doc2"})}))({doctor1StartPoint:n,Am1StartPoint:d,heliStartPoint:l,Am2StartPoint:s,doc2StartPoint:r}),{startTime:T,doc1EndTime:v,amb1EndTime:P,heliEndTime:w,amb2EndTime:b,doc2EndTime:E}=(()=>{const e=new Date(0);return{startTime:m.fromDate(e),doc1EndTime:m.fromDate(new Date(e.getTime()+3e4)),amb1EndTime:m.fromDate(new Date(e.getTime()+11e4)),heliEndTime:m.fromDate(new Date(e.getTime()+23e4)),amb2EndTime:m.fromDate(new Date(e.getTime()+3e5)),doc2EndTime:m.fromDate(new Date(e.getTime()+33e4))}})();(({doc1:e,amb1:t,heli:i,amb2:o,doc2:a},{doc1Path:n,Am1Path:d,heliPath:l,Am2Path:s,doc2Path:r},{startTime:m,doc1EndTime:h,amb1EndTime:u,heliEndTime:c,amb2EndTime:g,doc2EndTime:p})=>{F.addAnimation(e.id,{description:e.id,startTime:m,endTime:h,device:e,path:n}),F.addAnimation(t.id,{description:t.id,startTime:h,endTime:u,device:t,path:d}),F.addAnimationToDevice({description:i.id,startTime:u,endTime:c,device:i,path:l}),F.addAnimation(t.id,{description:o.id,startTime:c,endTime:g,device:t,path:s}),F.addAnimation(a.id,{description:a.id,startTime:g,endTime:p,device:e,path:r})})({doc1:h,amb1:u,heli:c,amb2:g,doc2:p},{doc1Path:e,Am1Path:t,heliPath:i,Am2Path:o,doc2Path:a},{startTime:T,doc1EndTime:v,amb1EndTime:P,heliEndTime:w,amb2EndTime:b,doc2EndTime:E}),(({startSceneTime:e,endSceneTime:t,currentTime:i})=>{L.playSceneAnimation({startTime:e.clone(),endTime:t.clone(),currentTime:i.clone(),speed:1})})({startSceneTime:T,endSceneTime:b,currentTime:T}),L.viewer.camera.flyTo({destination:h.position.getValue(T)}),(({doc1:e,amb1:t,heli:i,amb2:o,doc2:a},{doc1EndTime:n,amb1EndTime:d,heliEndTime:l,amb2EndTime:s,doc2EndTime:r})=>{let m=null;L.viewer.clock.onTick.addEventListener(h=>{const u=h.currentTime;m=U(u,{doc1:e,amb1:t,heli:i,amb2:o,doc2:a},{doc1EndTime:n,amb1EndTime:d,heliEndTime:l,amb2EndTime:s,doc2EndTime:r}),m.position.getValue(h.currentTime),L.viewer.trackedEntity=m,console.log(m)}),requestAnimationFrame(()=>{L.viewer.trackedEntity=m})})({doc1:h,amb1:u,heli:c,amb2:g,doc2:p},{doc1EndTime:v,amb1EndTime:P,heliEndTime:w,amb2EndTime:b,doc2EndTime:E})};var O={class:"object-management"},B={class:"title"},H={style:{width:"300px"}},J={class:"organizer"},Y={class:"organizer-title"},$={class:"element"},N={class:"element-title"},Q={class:"el-list-btn"},R=["onClick"],X=["onClick"],Z=I(T({__name:"ObjectManagemen",setup(e){const t=y("");g(t,(e,t)=>{e!==t&&_(()=>{console.log(e,t)},200),console.log(e,t)});const i=y("");g(i,(e,t)=>{e!==t&&(n.value=o.filter(t=>t.name.includes(e)))});const o=[{name:"军用车辆",uri:"GroundVehicle.glb"},{name:"飞机",uri:"Cesium_Air.glb"}],n=y(o),h=y([]),u=()=>{h.value=[],new G(x.viewer).startLeftCilck(e=>{h.value.push(e),console.log(h.value)})},T=e=>{x.viewer.entities.removeAll(),h.value.forEach((t,i)=>{t&&W({id:"entity"+l(),viewer:x.viewer,uri:e,position:d.fromDegrees(t.longitude,t.latitude,t.height)})}),h.value=[]},A=()=>{q()},S=()=>{h.value.pop()},I=()=>{V(j)},V=e=>{x.viewer.entities.removeAll();const t=[];e.forEach(e=>{const i=d.fromDegrees(e.longitude,e.latitude,e.height),o=a.fromDegrees(0,0,0);0!==i.x&&0!==i.y&&0!==i.z&&t.push({position:i,hpr:o})});const i=W({id:"entity"+l(),viewer:x.viewer,uri:"/models/GroundVehicle.glb",position:t[0].position});if(requestAnimationFrame(()=>{L.viewer.camera.flyTo({destination:i.position.getValue(m.fromDate(new Date))})}),i){(e=>{const{device:t,path:i,startTime:o,endTime:a}=e;F.addAnimation(1,{description:"test",startTime:o,endTime:a,device:t,path:i})})({description:"rotate animation",startTime:m.fromDate(new Date),endTime:m.fromDate(new Date(Date.now()+1e4)),device:i,path:t});const e={startTime:m.fromDate(new Date),endTime:m.fromDate(new Date(Date.now()+1e4)),speed:1,currentTime:m.fromDate(new Date)};L.playSceneAnimation(e)}h.value=[]};return(e,a)=>(P(),b("div",O,[f("div",B,[f("div",H,[a[6]||(a[6]=D(" 对象管理 ",-1)),p(r(c),{type:"primary",onClick:u},{default:k(()=>[...a[2]||(a[2]=[D("点位拾取",-1)])]),_:1}),p(r(c),{type:"primary",onClick:I},{default:k(()=>[...a[3]||(a[3]=[D("动画测试",-1)])]),_:1}),a[7]||(a[7]=D(" >",-1)),p(r(c),{type:"primary",onClick:A},{default:k(()=>[...a[4]||(a[4]=[D(" 综合演练demo",-1)])]),_:1}),p(r(c),{type:"primary",onClick:S},{default:k(()=>[...a[5]||(a[5]=[D("删除上一个点",-1)])]),_:1})])]),f("div",J,[f("div",Y,[a[8]||(a[8]=f("div",{class:"title-text"},"编组",-1)),p(r(C),{modelValue:t.value,"onUpdate:modelValue":a[0]||(a[0]=e=>t.value=e),placeholder:"搜索编组"},null,8,["modelValue"])]),a[9]||(a[9]=f("div",{class:"organizer-container"},null,-1))]),f("div",$,[f("div",N,[a[10]||(a[10]=f("div",{class:"title-text"},"元素",-1)),p(r(C),{modelValue:i.value,"onUpdate:modelValue":a[1]||(a[1]=e=>i.value=e),placeholder:"搜索元素"},null,8,["modelValue"])]),p(r(E),{class:"element-container","max-height":"400px"},{default:k(()=>[(P(!0),b(w,null,v(n.value,e=>(P(),b("div",{class:"el-list",key:e.name},[f("div",null,s(e.name),1),f("div",Q,[f("div",{class:"btn",onClick:t=>(e=>{console.log(e)})(e.name)},"信息",8,R),a[11]||(a[11]=D(" | ",-1)),f("div",{class:"btn",onClick:t=>(e=>{const t=o.find(t=>t.name===e);t&&T(`/models/${t.uri}`)})(e.name)},"定位",8,X)])]))),128))]),_:1})])]))}}),[["__scopeId","data-v-b6359de1"]]),ee={class:"page2-view"},te=I(T({__name:"Index",setup:e=>(e,t)=>(P(),b("div",ee,[p(Z)]))}),[["__scopeId","data-v-1823eb6b"]]);export{te as default};